<analysis>**original_problem_statement:**
The user wants to build a full-stack application to sell textbooks online.

**PRODUCT REQUIREMENTS:**
1.  **Product Management:** Add, edit, and manage textbook products, categorized by grade and subject. Track inventory.
2.  **Customer Profiles:** Accounts for parents, with profiles for one or more students (children).
3.  **Order Form:** An easy-to-use form for parents to select a student and order textbooks. Should support auto-fill for repeat orders.
4.  **Admin Dashboard:** View, search, edit, and fulfill orders; add new products; update stock; and receive low inventory alerts.
    *   **Enhancement 1:** The Add Product form should be a table to allow adding multiple products at once.
    *   **Enhancement 2:** Implement CSV import and export for products.
5.  **Print Order Receipts:** Generate a printable order document formatted for a thermal printer.
6.  **Monday.com Integration:** Automatically send order and customer details to a designated Monday.com board when a new order is submitted.
7.  **Embeddable Form:** The order form should be embeddable as a standalone widget/iframe on an external website (like Invisionpower Suite) and should not require user registration. It should use the inventory system and trigger the Monday.com integration. The fields of this form should be configurable from the admin dashboard.
8.  **Notification System:** A persistent, small notification bar in the admin dashboard for configurable alerts (e.g., new orders, low stock).
9.  **Design & Usability:** Clean, user-friendly, responsive design.
10. **Internationalization:** Use Spanish terms for code/database values. The frontend UI must support both Chinese and Spanish, with language auto-detection and a toggle button.
11. **Payments:** Initial support for manual bank transfers. Future integration with Yappy Comercial from Panama.

**User's preferred language**: Spanish

**what currently exists?**
A full-stack application with a FastAPI backend and React frontend.
- **Authentication:** JWT-based user registration and login is implemented.
- **Internationalization:** The frontend supports Spanish and Chinese with a working language toggle and dark/light mode.
- **Backend:** Models and API endpoints exist for products (), customers (), students (), and orders ().
- **Admin Dashboard:** A comprehensive admin dashboard is in place, allowing management of products, orders, and inventory. It includes:
    - A summary view with stats.
    - A product list.
    - A feature to add products in bulk via a dynamic table.
    - A feature to export the product list to a CSV file.
- **In-Progress Features:** The backend and frontend foundations for an embeddable order form and an admin notification bar have been created.

**Last working item**:
    - Last item agent was working: The agent was implementing two major features requested by the user: a standalone, embeddable order form and an admin notification system. It had just added the backend API endpoints (, , ) in  and created the basic frontend components (, ). The agent was in the process of integrating the  component into the main  layout.
    - Status: IN PROGRESS
    - Agent Testing Done: N
    - Which testing method agent to use? both
    - User Testing Done: N

**All Pending/In progress Issue list**:
  - Issue 1: CSV Import is broken (P0)

  Issues Detail:
  - Issue 1: 
     - Attempted fixes: The agent implemented the UI and logic for CSV import in  using the  library's concepts. However, it never installed the required dependency ( or ). When the Import CSV button is used and a file is selected, the application will crash because the parsing library is not available.
     - Next debug checklist: 
        1. Install the CSV parsing library: yarn add v1.22.22
[1/4] Resolving packages...
[2/4] Fetching packages...
[3/4] Linking dependencies...
[4/4] Building fresh packages...
success Saved lockfile.
success Saved 1 new dependency.
info Direct dependencies
└─ papaparse@5.5.3
info All dependencies
└─ papaparse@5.5.3
Done in 64.20s..
        2. Verify the import statement in  matches the installed library (e.g., ).
        3. Retest the CSV import functionality end-to-end.
     - Why fix this issue and what will be achieved with the fix? This is a user-requested feature for bulk product management. Fixing it will allow the admin to efficiently add a large number of products from a CSV file.
     - Status:  NOT STARTED
     - Is recurring issue? N
     - Should Test frontend/backend/both after fix? Frontend
     - Blocked on other issue: None

**In progress Task List**:
  - Task 1: Complete Standalone Embeddable Order Form (P1)
  - Task 2: Complete Admin Notification System (P2)

 Task Detail:
  - Task 1: 
     - Where to resume: The backend endpoint () and a basic frontend page () have been created. The next steps are to fully develop the UI of the embeddable form, ensure it fetches product data, validates user input, submits the order to the new public endpoint, and correctly deducts from inventory and triggers the Monday.com integration.
     - What will be achieved with this? This will fulfill a key user requirement to capture orders from an external website without forcing customers to create an account, thereby reducing friction.
     - Status:  IN PROGRESS
     - Should Test frontend/backend/both after fix? Both
     - Blocked on something: None
  - Task 2: 
     - Where to resume: The backend endpoint () and a UI component () have been created. The agent was adding this component to . The next steps are to ensure the component fetches notifications, displays them correctly in a persistent top bar, and implements the logic for marking notifications as read. Also, the backend logic for *creating* notifications (e.g., for low stock or new public orders) needs to be integrated into the relevant API endpoints.
     - What will be achieved with this? This will provide the admin with real-time updates on important application events, improving store management efficiency.
     - Status:  IN PROGRESS
     - Should Test frontend/backend/both after fix? Both
     - Blocked on something: None

**Upcoming and Future Tasks**
    Upcoming Tasks:
    - **Admin UI for Form Configuration (P2):** Build the frontend interface within the Admin Dashboard that allows the admin to manage the fields of the embeddable order form, using the  endpoints.
    - **Thermal Printer Receipt Formatting (P3):** Implement the specific CSS and layout for the  page to ensure it prints correctly on a standard thermal printer.
    
    Future Tasks:
    - **Verify Monday.com Integration (P4):** Although the backend function exists, it needs to be explicitly tested, especially its triggering from the new public order endpoint.
    - **Yappy Comercial Payment Integration (P5):** Integrate the Panama-based payment gateway as a payment option.

**Completed work in this session**
- List of all completed tasks with file and method name:
  - **User Authentication:** Implemented JWT-based registration and login.
  - **Multi-language & Theming:** Integrated Spanish/Chinese languages with a working toggle () and a light/dark mode theme toggle.
  - **Admin Product Management:**
    - Bulk Product Creation: Implemented a table-based form in  to add multiple products at once.
    - CSV Product Export: Implemented functionality in  to export all products to a CSV file.
  - **Core Application Structure:** Created all initial pages, routing (), contexts (, ), and backend API structure ().

- Recently completed:
  - Bulk Product Add (DONE)
  - CSV Product Export (DONE)
  - Language Toggle and Theming (DONE)

**Earlier issues found/mentioned but not fixed**
   - Issue 1: The CSV Import feature is broken. The UI was built in , but the required  dependency was never installed, which will cause a runtime crash.
     - Debug checklist:
       1. Run yarn add v1.22.22
[1/4] Resolving packages...
[2/4] Fetching packages...
[3/4] Linking dependencies...
[4/4] Building fresh packages...
success Saved 1 new dependency.
info Direct dependencies
└─ papaparse@5.5.3
info All dependencies
└─ papaparse@5.5.3
Done in 6.20s..
       2. Check  to ensure  is used correctly.
       3. Test the import flow.
     - Why to solve this issue and what will be achieved with this? This is a core part of the user's request for efficient bulk product management.
     - Should Test frontend/backend/both after fix: Frontend
     - Is recurring issue? N

**Known issue recurrence from previous fork**
  - None

**Code Architecture**


**Key Technical Concepts**
- **Backend:** FastAPI, MongoDB (via ), Pydantic for data validation, JWT for authentication.
- **Frontend:** React, React Router, Axios for API calls, Tailwind CSS for styling, Shadcn/UI for components.
- **Internationalization:**  and  for Spanish and Chinese language support.

**key DB schema**
  - **libros:** { , , , , , ,  }
  - **clientes:** { , , ,  ('cliente' or 'admin'),  }
  - **estudiantes:** { , ,  }
  - **pedidos:** { , , , , ,  ('pendiente', 'confirmado', 'enviado'),  }
  - **notificaciones:** { ,  ('stock', 'pedido'), ,  }
  - **form_configs:** { ,  (dictionary of form fields) }

**changes in tech stack**
  - None.

**All files of reference**
- : The single file containing the entire FastAPI backend, including all models, routes, and business logic. Recently updated with endpoints for public orders and notifications.
- : A large component managing the entire admin interface. Recently updated to add bulk add, CSV import/export, and is the source of the broken CSV import feature.
- : A new page created to serve as the standalone, embeddable order form.
- : A new component for the admin notification system.
- : The main router for the frontend application. Recently updated to add the .
- : Contains all translation strings for Spanish and Chinese.

**Areas that need refactoring**:
- The  component has grown very large (over 1000 lines) and contains logic for multiple tabs, dialogs, and features (bulk add, CSV import/export, product editing, etc.). It should be broken down into smaller, more manageable sub-components.
- The  file contains all backend logic. It could be split into separate files for models, routes, and services for better organization as the application grows.

**key api endpoints**
- , : User authentication.
- : Fetch all textbook products.
- : Create a new order (for authenticated users).
- , : Fetch data for the admin dashboard.
- : Add multiple products at once.
- : **(New)** Create a new order without authentication for the embeddable form.
- : **(New)** Fetch notifications for the admin bar.
- : **(New)** Manage the configuration of the embeddable form.

**Critical Info for New Agent**
The most critical issue is that the CSV import feature in  is broken. The agent wrote the code to parse a CSV file but **forgot to install the  dependency**. This needs to be fixed with yarn add v1.22.22
[1/4] Resolving packages...
[2/4] Fetching packages...
[3/4] Linking dependencies...
[4/4] Building fresh packages...
success Saved lockfile.
success Saved 1 new dependency.
info Direct dependencies
└─ papaparse@5.5.3
info All dependencies
└─ papaparse@5.5.3
Done in 0.25s. before proceeding. The agent was also in the middle of a major feature implementation (embeddable form and notifications), which is incomplete and untested.

**documents and test reports created in this job**
- 
- 
- 

**Last 10 User Messages and any pending HUMAN messages**
10. **User:** Asks to add CSV export functionality.
9. **Agent:** Implements CSV export. (Completed)
8. **User:** Requests two major new features: 1) A standalone, embeddable order form that doesn't require registration but uses the inventory and Monday.com integration. 2) A persistent notification bar in the admin dashboard for alerts like low stock.
7. **Agent:** Acknowledges the request and starts implementation. (In Progress)
6. **User:** Asks to add a CSV import feature.
5. **Agent:** Implements the UI and logic for CSV import. (Completed, but broken)
4. **User:** Confirms the new bulk-add product form is working and asks for CSV import.
3. **Agent:** Finishes and confirms the functionality of the bulk-add product form. Suggests adding CSV import.
2. **User:** Asks to change the single-product Add Product form to a table-based form for adding multiple products at once.
1. **Agent:** Acknowledges the request and begins modifying the  component.

**Project Health Check:**
- **Broken:** The CSV Product Import feature in  is non-functional due to a missing  npm package.
- **Mocked:** None.

**3rd Party Integrations**
- **Monday.com:** Logic is present in  () but end-to-end testing, especially with the new public order endpoint, is pending. Requires user-provided API key.
- **Yappy Comercial:** Requested by the user, but not yet implemented.

**Testing status**
  - Testing agent used after significant changes: YES
  - Troubleshoot agent used after agent stuck in loop: NO
  - Test files created: None
  - Known regressions: None

**Credentials to test flow:**
An admin user has been created. The credentials can be found in the agent's thought process when it created the user (Message 50 & 51).
- Email: 
- Password: 

**What agent forgot to execute**
- **yarn add v1.22.22
[1/4] Resolving packages...
[2/4] Fetching packages...
[3/4] Linking dependencies...
[4/4] Building fresh packages...
success Saved 1 new dependency.
info Direct dependencies
└─ papaparse@5.5.3
info All dependencies
└─ papaparse@5.5.3
Done in 0.21s.:** The agent implemented the CSV import feature in  but forgot to install the necessary dependency, rendering the feature broken.
- **Thermal Printer Formatting:** The requirement to format order receipts for a thermal printer has not been addressed.
- **Admin UI for Form Fields:** The requirement for the admin to configure the fields of the embeddable form has backend endpoints but no corresponding frontend UI has been built.</analysis>
